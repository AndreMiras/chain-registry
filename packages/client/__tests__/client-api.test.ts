import request from 'supertest';

import { ChainRegistryClient } from '../src/client';

const timeout = 5000;
const host = 'https://raw.githubusercontent.com';

describe('Test chain registry urls', () => {
  it(
    'test urls generated by client',
    () => {
      const client = new ChainRegistryClient({
        chainNames: ['osmosis', 'juno']
      });
      expect(client.urls.length).toEqual(5);

      return Promise.all(
        client.urls.map((url) =>
          request(host)
            .get(url.slice(host.length))
            .timeout(timeout)
            .expect(200)
            .then((response) => {
              expect(JSON.parse(response?.text).$schema).toBeDefined();
            })
        )
      );
    },
    timeout
  );
});
